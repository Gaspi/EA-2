
\documentclass[12pt,a4paper,titlepage]{article}

\usepackage[utf8]{inputenc}
\usepackage[english]{babel}
\usepackage[left=1.5cm,right=2cm,top=2cm,bottom=2cm]{geometry}

\input{defines}

% \newcommand{\GF}[1]{\text{GF}(#1)}
\newcommand{\GF}[1]{\F_{#1}}


% More definitions
\usepackage{showkeys}
\usepackage{mathtools}
%\usepackage{multirow}
%\usepackage{appendix}



\author{Sylvain Colin \& Gaspard FÃ©rey}
\title{The Sidelnikov-Shestakov's Attack applied to the Chor-Rivest Cryptosystem}

\begin{document}

\maketitle
\tableofcontents


\begin{abstract}

In this article, we discuss about the Sidelnikov-Shestakov attack on cryptosystems based on Reed-Solomon codes. Then we describe how this algorithm can be used to improve the attack to the Chor-Rivest Cryptosystem proposed by Vaudenay \cite{Vau01}.

\end{abstract}



\newpage
\section{Introduction}
\label{sec:intro}

Niederreiter and McEliece cryptosystem \cite{NiederH86} was one of the first to use randomization in the encryption process. Indeed, in such a scheme, the encrypter uses a random error to prevent attacks on the codeword. This codeword is then decrypted using an error-correcting Reed-Solomon code. This algorithm has never gained much acceptance in the cryptographic community, but is a candidate for "post-quantum cryptography".

In 1992, Sidelnikov and Shestakov suggest an attack \cite{SidelShes92} on the public key of this cryptosystem using equivalences between private keys.

The Chor-Rivest cryptosystem \cite{ChorRiv88} is a public key knapsack system which has been broken.  However, it took longer to break than most, and is a very elegant use of finite fields.

The first efficient attack for the proposed parameters (i.e., $p \simeq 200$, $h \simeq 24$) has been obtained by Vaudenay in 2001, assuming $h$ has a small factor.


\subsection{Our Work}
In this article, we first describe the Niederreiter and McEliece cryptosystem and present the original Sidelnikov and Shestakov's attack. We use here the echelon form of the public key as suggested by Wieschebrink \cite{Wiesch}. This gives an easy algorithm to attack such a scheme.

On a second part, we focus on the Chor-Rivest cryptosystem and show some similarities between the "known $g_{p^r}$ attacks" introduced by Vaudenay and the  Sidelnikov-Shestakov attack. This allow us to describe an algorithm for a "known $g_{p^r}$ attacks" which doesn't require $r$ to be as big as in Vaudenay's article. In particular the term $p^{\sqrt{h}}$ in Vaudenay's complexity corresponding to an exhaustive research can be reduced to $p^{\log p}$ assuming we have $h \simeq \frac{p}{\log p}$ as suggested in Chor and Rivest's article and $h$ has very small factors (around $\log p$). That last point should be verified since the scheme can only be used efficiently when $h$ has a lot of divisors in order to be able to compute discrete logarithms for the public key.



\newpage
\section{Preliminaries}
\label{sec:Prel}


\subsection{A cryptosystem based on Reed-Solomon codes}

We study here the public-key cryptosystem introduced by Niederreiter and McEliece \cite{NiederH86} applied to the generalized Reed-Solomon codes. Let $\F_q$ be a finite field with $q = p^h$ elements and $\F = \F_q \cup \{ \infty \}$, where $\infty$ has usual properties ( $1/\infty = 0$, etc). We call $\A$ the following matrix:
$$ \A(\alpha_1, \ ... \ , \alpha_n, z_1, \ ... \ , z_n) := \left(
\begin{array}{cccc}
z_1 \alpha_1^0 &  z_2 \alpha_2^0 & \cdots & z_n \alpha_n^0 \\
z_1 \alpha_1^1 &  z_2 \alpha_2^1 & \cdots & z_n \alpha_n^1 \\
 & & \ddots & \\
z_1 \alpha_1^{k-1} &  z_2 \alpha_2^{k-1} & \cdots & z_n \alpha_n^{k-1}
\end{array}
\right) \in \mathcal{M}_{\F_q}(k,n) $$
where $\alpha_i \in \F$ and $z_i \in \F_q\backslash\{0\}$ for all $i \in \{1,...,n\}$. Note that, if $\alpha_i = \infty$, we replace the $i^{th}$ column by the vector $z_i(0,...,0,1)^T$, so that all the coefficients of the matrix are finite.

\bigskip

In the considered cryptosystem, the secret key consists of
\begin{itemize}
\item The set $\{\alpha_1,... ,\alpha_n\}$;
\item The set $\{z_1,... ,z_n\}$;
\item A random nonsingular $k\times k$-matrix $H$ over $\F_q$.
\end{itemize}

The public key is
\begin{itemize}
\item The representation of the field $\F_q$, that is the polynomial used to define $\F_q$ over $\F_p$;
\item The two integers $k$ and $n$ such that $ 0 < k < n \leq q$.
\item $M := H \cdot \A(\alpha_1, \ ... \ , \alpha_n, z_1, \ ... \ , z_n)$.
\end{itemize}

The codewords are then the vectors $c=b.M$ where $b\in\F_q^k$. So, the different codewords have necessarily the following form :

$$c=(z_if_c(\alpha_i))_{1\leq i\leq n}$$ where $f_c$ is a polynomial whose degree is at most $k-1$.


Thus, given a message to send, which is actually a vector $b$ of $\F_q^k$, one will have to transmit the vector $b.M + e$ where $e$ is a random vector of $\F_q^n$ with Hamming weight at most $t=\lfloor\frac{n-k}{2}\rfloor$.
So, since a GRS code correct at most $t=\lfloor\frac{n-k}{2}\rfloor$ error, the original message can be recovered by computing $b'=b.M$, finding the closest codeword from the received message, and then computing $b'M^{-1}$.
However, the original message can not be easily recovered when not knowing the GRS code used in the secret key.

\subsection{Equivalence between Reed-Solomon codes}

Sidelnikov and Shestakov show \cite{SidelShes92} that for all $a \in \F_q\backslash\{0\}$ and $b \in \F_q$, there exists $H_1, H_2, H_3 \in \mathcal{M}_{F_q}(k,k)$ invertible such that
\begin{eqnarray*}
H_1 \A(a\cdot\alpha_1 + b, \ ... \ , a\cdot \alpha_n + b, c_1z_1, \ ... \ , c_n z_n) &=& \A(\alpha_1, \ ... \ , \alpha_n, z_1, \ ... \ , z_n) \\
H_2 \A\left( \frac{1}{\alpha_1}, \ ... \ , \frac{1}{\alpha_n}, d_1z_1, \ ... \ , d_n z_n \right) &=& \A(\alpha_1, \ ... \ , \alpha_n, z_1, \ ... \ , z_n) \\
H_3 \A\left( \alpha_1, \ ... \ , \alpha_n, a\cdot z_1, \ ... \ , a\cdot z_n \right) &=& \A(\alpha_1, \ ... \ , \alpha_n, z_1, \ ... \ , z_n)
\end{eqnarray*}
This means that for any cryptosystem $M = H \A(\alpha_1, \ ... \ , \alpha_n, z_1, \ ... \ , z_n)$, for any birationnal transformation
$$ \phi : x \mapsto \frac{ax+b}{cx+d} $$
$M = H_{\phi} \A(\phi(\alpha_1), \ ... \ , \phi(\alpha_n), z'_1, \ ... \ , z'_n)$ and by using the unique transformation $\phi$ that maps $(\alpha_1, \alpha_2, \alpha_3)$ to $(0,1,\infty)$, we get that for any cryptosystem $M = H \A(\alpha_1, \ ... \ , \alpha_n, z_1, \ ... \ , z_n)$, $M$ can be uniquely written
$$ M = H' \A(0, 1, \infty, \alpha'_4, \ ... \ , \alpha'_n, z'_1, \ ... \ , z'_n) $$
with $H'$ nonsingular, $z'_i \neq 0$ and $\alpha_i$ distincts elements of $\F_q-\{0, 1, \infty)$.

So, when $M$ is given, it is impossible to compute the original matrices $\A$ and $H$ since many pairs of such matrices lead to the same public matrix $M$. However, computing an equivalent pair is sufficient
since it will allow to decipher the messages as well as the original secret pair of matrices. So, the attack will consist of finding $H$ and $\A(0, 1, \infty, \alpha'_4, \ ... \ , \alpha'_n, z'_1, z'_2, \ ... \ , z'_n)$, equivalent to the original pair. 
We can also assume that $z'_1=1$. Indeed, if we multiply all the elements $z'_i$ by a factor $a \in \F_q$ and all the elements of the matrix $H$ by $a^{-1}$, the resulting matrix $M$ will be the same.


\newpage
\section{The Sidelnikov-Shestakov Attack}
\label{sec:SSattack}

The attack of Sidelnikov-Shestakov consists of the following steps.
\bigskip

First we assume that the public key is as described in the previous section :
$$ M = H' \A(0, 1, \infty, \alpha'_4, \ ... \ , \alpha'_n, 1, z'_2, \ ... \ , z'_n) $$

We compute then the echelon form of $M$.
$$ E(M) = 
\left(
\begin{array}{ccccccc}
1 & 0 & \cdots & 0 & b_{1,k+1} & \cdots & b_{1,n} \\
0 & 1 & \cdots & 0 & b_{2,k+1} & \cdots & b_{2,n} \\
  &   & \ddots &   & \vdots &   & \vdots \\
0 & \cdots & 0 & 1 & b_{k,k+1} & \cdots & b_{k,n}
\end{array}
\right) = H'' \cdot M
$$

Since the echelon form can be computed only with left multiplication of the matrix M, the $k$ lines of $E(M)$ are codewords. As a consequence, if we call $f_i$ the polynomial associated to the $i^{th}$
line, we have :
\begin{itemize}
\item $\forall$  $1\leq i\leq k, f_i(\alpha_i)=1 $
\item $\forall$  $1\leq i\neq j\leq k, f_i(\alpha_j)=0 $
\item $\forall$  $1\leq i\leq k$ $\forall$ $k+1\leq j\leq n$, $f_i(\alpha_j)=b_{i,j} $
\end{itemize}
So, since all the $\alpha_i$ are different, the polynomial $f_i$ has $k-1$ simple roots. As a consequence, $b_{i,j}\neq0$ for all $1\leq i\leq k$ and $k+1\leq j\leq n$. Moreover, we know the general 
form of the polynomial $f_i$ :
$$f_i(X) = c_i.\prod_{1\leq j\leq k, i\neq j} (X-\alpha_j)$$ where $c_i \in \F\backslash{0}$.

For $2 \leq k \leq n-2$, this attack works with a complexity of ...


\newpage
\section{Application to the Chor-Rivest Cryptosystem}
\label{sec:CRcrypt}

\subsection{The Chor-Rivest Cryptosystem}

Secret keys consist of
\begin{itemize}
\item an element $t \in \GF{q}$ with algebraic degree $h$
\item a generator $g$ of $\GF{q}^{\ast} $
\item an integer $d \in \Z_{q-1} $
\item a permutation $\pi$ of $\{ 0, ... , p-1 \}$.
\end{itemize}

Public keys consist of all
$$ c_i = d + \log_g(t + \alpha_{\pi(i)}) \mod q-1 $$

The message consists in a bitstring $m = [m_0...m_{p-1}]$ of length $p$ such that $\sum_i m_i = h$. The ciphertext is
$$ E(M) := \sum_{i=0}^{p-1} m_i c_i$$
To decipher this message, we compute
$$ g^{E(M) - hd} =  \prod_i \left( t + \alpha_{pi(i)}\right)^{c_i} $$

% Explain here how to retrieve then the c_i



When we attack this cryptosystem, we can consider a generator $g_0 = g^u$ with $u$ unknown and $\gcd(u, q-1) = 1$ we then have
$$ g_0^{c_i} = \left( g^d \left( t + \alpha_{\pi(i)} \right) \right)^u = \left(A + \alpha_{\pi(i)} \cdot B\right)^u$$
We can then consider that the secret key is
\begin{itemize}
\item $A \in \F_q$.
\item $B \in \F_q$ such that $t = A\cdot B^{-1}$ has algebraic degree $h$.
\item $0 < u < q-1$ prime with $q-1$.
\item the permutation $\pi$ of $\{ 0, ... , p-1 \}$.
\end{itemize}
and public key consists in all the
$$ d_i := \left(A + \alpha_{\pi(i)} \cdot B\right)^u \in \F_q$$
The ciphertext becomes
$$ E'(M) := \prod_{i=0}^{p-1} d_i^{m_i} = g^{uE(M)} = B^{uh} \left( \prod_i \left( t + \alpha_{pi(i)}\right)^{c_i} \right)^u$$
Knowing $u$, $B$ and $h$, it is easy to compute from $E'(M)$, the following quantity
$$ \prod_i \left( t + \alpha_{pi(i)}\right)^{c_i} $$
which allow us to retrieve all the $c_i$.


\subsection{Link with Reed-Solomon codes}

Trying to attack this cryptosystem show some relations between this problem and the previous one studied in section \ref{sec:Prel}. In particular we have the following theorem.

\begin{theorem}
\label{thm:link}
Let $2 \leq k \leq p-2$.
Suppose there exists $(Q_i)_{0 \leq i \leq k-1}$ $k$ polynomials of $\GF{p}[X]$ linearly independent with degree smaller than $k-1$.
Suppose the evaluations $m_{i,j} := Q_i(\alpha_{\pi(j)})$ is known for all $i$ and $j$.
Then the permutation $\pi$ can be recovered in polynomial time using a Sidelnikov-Shestakov attack on the matrix $M = (m_{i,j})_{i,j} \in \mathcal{M}_{k,p}(\GF{p})$.
\end{theorem}
\begin{proof}
We suppose here that one of the $Q_i$ has a degree exactly $k$.
Then we write the square non singular matrix $H = (h_{i,j}) \in \mathcal{M}_k(\GF{p})$ of the coefficients of the $Q_i$
$$ Q_i(X) = \sum_{j=0}^{k-1} h_{i,j} X^j $$
If we still consider
$$ \A_k := \left( \alpha_{\pi(j)}^i \right)_{0 \leq i < k, 0 \leq j \leq p-1} \in \mathcal{M}_{k,p}(\GF{p})$$
We have the equality
$$ H \cdot \A_k = M$$
with $H$ non singular and since $k \leq p-2$, this is exactly the public key of a cryptosystem based on the Reed-Solomon codes described in section \ref{sec:Prel}.
\end{proof}

So a possible way to attack the Chor-Rivest cryptosystem would be to find the evaluations of enough small degree polynomials in the $\alpha_{\pi(i)}$.



\subsection{A First Attack using Reed-Solomon codes}

We have for all $j$
$$ g^{c_j} = g^d \cdot (t + \alpha_{\pi(j)} ) = A + \alpha_{\pi(j)} \cdot B $$
where $\alpha_{\pi(j)} \in \GF{p}$ and $A$ and $B$ are elements of $\GF{p^h}$.

A naive attack would be then to try to guess at random the generator $g$. We will see that although finding the precise $g$ is very unlikely, there is a family of generators that can still allow us to retrieve $\pi$.

\subsection{Small power of $g$}

As an attempt to guess $g$, we can choose a random generator $g_0$ of $\GF{q}^{*}$. We have $g_0 = g^u$ and
$$ g_0 ^{c_j} = (A + \alpha_{\pi(j)} \cdot B)^u $$
if we write this quantity in a certain base $(e_i)_{1 \leq i \leq h}$ of $\GF{p^h}$, we notice that each coordinate is a polynomial $Q_i$ in the $\alpha_{\pi(j)}$.
$$ g_0^{c_j} = \sum_{i=1}^h Q_i(\alpha_{\pi(j)}) e_i $$
where $Q_i$ has its coefficients in $\GF{p}$.
$Q_i$ depends on $A$, $B$, $u$ and obviously on $i$. However, $Q_i$ does not depend on $j$.

Besides, we have
\begin{itemize}
\item $\deg Q_i \leq u$
\item $\deg Q_i < p$ since $\alpha_{\pi(j)}^p = \alpha_{\pi(j)}$.
\end{itemize}

This means that we have access to the evaluations in the $\alpha_{\pi(j)}$ of $h$ polynomials of degree smaller than $u$. According to Theorem~\ref{thm:link}, a sufficient condition for this attack to work is $u \leq h-1 \leq p-3$. The last inequality is most likely true since $h$ is chosen close to $p / \log p$. However there are only $h-1$ different elements of $\GF{p^h}$ fulfilling the first one.
This only slightly improves the exhaustive research of $g$.


\subsection{Wider set of generators}

We can notice that if $u = u'p$,
$$ g_0^{c_j} = (A + \alpha_{\pi(j)} \cdot B)^{u'p} = (A^p + \alpha_{\pi(j)} \cdot B^p)^{u'} $$
and the coordinates of this quantity are polynomials of degree $u'$ in $\alpha_{\pi(j)}$.
This also means that if $u$ is written $u = \sum_{i=0}^{h-1} u_i p^i$ in base $p$, then
$$ g_0^{c_j} = \prod_{i=0}^{h-1} (A^{p^i} + \alpha_{\pi(j)} \cdot B^{p^i} )^{u_i} $$
whose coordinates are a polynomial of degree $w_p(u) := \sum_{i=0}^{h-1} u_i$ in the $\alpha_{\pi(j)}$.

This mean that all $u$ such that $w_p(u) < h$ allow to retrieve the permutation and break the cryptosystem.
The number of such $u$ is
$$ \left( \binom{h+1}{h-1} \right) = \binom{2h}{h-1} =\Theta\left( 4^h \sqrt{h} \right) $$
This is a drastic improvement in the exhaustive research of $g$. However this remains quite small compared to the number $\phi(p^h-1)$ of different generators in $\GF{p^h}$ which is comparable to $p^h$.




\newpage
\section{Vaudenay attack}
\label{sec:Vau}

We can see that the previous attack requires to find a generator of $\F_q$ among the elements that can be written $g^u$ with $w_p(u) \leq h$. Since there are very few of such elements compared to the $\phi(p^h)$ different generators of $\F_q$, Vaudenay suggests \cite{Vau01} to consider a generator $g_{p_r}$ of the sub-field $\F_{p^r}$ of $\F_{p^h}$. He introduces the following theorem
\begin{theorem}
For any factor $r$ of $h$, there exists a generator $g_{p^r}$ of the multiplicative group of the subfield $\F_{p^r}$ of $\F_q$ and a polynomial $Q$ with degree $h/r$ whose coefficients are in $\F_{p^r}$ and such that $-t$ is a root and for all $j$ , we have $Q(\alpha_{\pi(j)}) = g_{p^r}^{c_j}$.
\end{theorem}

If we chose a base $(e_i)_{1 \leq i \leq r}$ of $\GF{p^r}$, we can write the coefficients of $g_{p^r}^{c_j}$ in this base as polynomials $Q_i$ in $\alpha_{\pi(j)}$. We get
$$ g_{p^r}^{c_j} = \sum_{i=1}^r Q_i(\alpha_{\pi(j)}) e_i $$
with $\deg Q_i \leq h/r$. We get the evaluation of $r$ polynomials of degree smaller than $h/r$.

This means that instead of searching a generator among the approximately $p^h$ generators of $\F_q$, we could search only within $\F_{p^r}$ with $r$ as small as possible. We notice that to be able to apply Theorem~\ref{thm:link}, we must have $h/r < r$. This yields the following theorem.

\begin{theorem}
When $r > \sqrt{h}$, there exists a polynomial "known $g_{p^r}$" attack on the Chor-Rivest cryptosystem.
\end{theorem}

This theorem is basically the main result from Vaudenay's article \cite{Vau01}. It states that to attack the Chor-Rivest cryptosystem, one can only search for the generator $g_{p^r}$ among $\Theta\left(p^r\right)$ possible choices instead of the exhaustive research for $g$ ($\Theta\left(p^h\right)$ choices).

However the "known $g_{p^r}$ attack" suggested in Vaudenay's article can be improved in two ways.

\begin{itemize}
\item First it is only polynomial when $r > \sqrt{h}$. We will see that using a Reed-Solomon attack, we can still retrieve $\pi$ in polynomial time provided we manage to get enough linearly independent polynomials in the $\alpha_{\pi(j)}$ which is possible even for small values of $r$ using $g_{p^r}^u$ with $u$ small enough.
\item Besides, the Reed-Solomon attack doesn't require the knowledge of all the $c_j$. Only $O(h)$ (or a little more when considering the attack for $r$ small) of them. So actually only a small proportion of them is enough. This makes this attack strong.
\end{itemize}




\subsection{Generating more rows...}
When we find $g_{p^r}$ such that $g_{p^r}^{c_j} = Q(\alpha_{\pi(j)})$ where $\deg Q \leq h/r$, we only have $r$ rows corresponding to the $r$ different polynomials of the coordinates of $g_{p^r}^{c_j}$ in a certain base of $\F_{p^r}$. Being able to generate more row would allow to chose a lower $r$ and improve drastically the attack.

We could consider now the coordinates of $g_{p^r}^{u c_j}$ for $u$ such that $w_p(u)$ remains small. For example, we could decide $w_p(u) \leq w$.

This should yield (assuming $w \gg r$) up to
$$ \left( \binom{r+1}{w} \right) = \binom{r+w+1}{w} = \binom{r+w+1}{r+1} = \Theta\left(\frac{w^{r+1}}{(r+1)!}\right) $$
different polynomials of degree at most $w \cdot \frac{h}{r}$.
Unfortunately, it seems probable that these are strongly linearly dependent...

For example, the coordinates of $g_{p^r}^{p c_j}$ are linearly dependent on the coordinates of $g_{p^r}^{c_j}$. Indeed, when decomposed in a normal base of $\F_{p^r}$, these two sets of vectors of coordinates only differs by a rotation.


\subsection{Simulation}

We run a simulation with the following parameters
\begin{itemize}
\item $p = 197$, $h = 24$, $r = 3 < \sqrt{h}$.
\item We define $\F_q$ as the quotient of $\F_p[X]$ by the polynomial
\begin{eqnarray*}
X^{24} &+& 192X^{23} + 152X^{22} + 25X^{21} + 75X^{20} + 67X^{19} + 92X^{18} + 23X^{17} + 45X^{16} + 97X^{15} \\
 &+& 2X^{14} + 21X^{13} + 106X^{12} + 130X^{11} + 128X^{10} + 136X^9 + 195X^8 + 95X^7 + 155X^6 \\
 &+& 34X^5 + 51X^4 + 180X^3 + 97X^2 + 23X + 87
\end{eqnarray*}
\item We choose $g := X + 2$ the private multiplicative generator.
\item We compute
\begin{eqnarray*}
g_{p^r} &=& g^{\frac{p^h-1}{p^r-1}} \\
&=& 153X^{23} + 168X^{22} + 167X^{21} + 45X^{20} + 128X^{19} + 68X^{18} + 103X^{17} + 11X^{16}\\
&&+ 139X^{15} + 190X^{14} + 75X^{13} + 73X^{12} + 190X^{11} + 64X^{10} + 173X^9 + 34X^8 \\
&&+ 88X^7 + 30X^6 + 139X^5 + 146X^4 + 111X^3 + 80X^2 + 136X + 48\\
\end{eqnarray*}
\item We choose different values for $d$, $t$ and $\pi$, the results remain the same.
\item We choose the base $\left(g_{p^r}, g_{p^r}^p, g_{p^r}^{p^2} \right)$ for the $\F_p$-vector space $\F_{p^r}$ (but this is of no influence on the results).
\item We choose $(u_i)_{1\leq  i \leq 11} = (1,2,p+1,3,2p+1,p+2,4,p+3,3p+1,2p+2,2p^2+p+1)$\\
We have $w_p(u_i) \leq 4$ so the coordinates of $g_{p^r}^{u_i c_j}$ are polynomials of degree smaller than $4 h/r+1 = 33$ in the $\alpha_{\pi(j)}$.
\end{itemize}
As a result, we obtain $11 \times 3 = 33$ lines of coordinates linearly independent (the simulation is the verification of this independence). This would allow the attack to retrieve the permutation $\pi$ using the attack on the cryptosystem based on Reed-Solomon codes.

This proves that it is possible to duplicate the number of lines at the expense of the degree of the polynomials considered. Therefore the condition $r \geq \sqrt{h}$ is not absolutely necessary and we can hope to get a (far) smaller lower bound on $r$.

On the following tabular, we present the results of several simulations for different value of $p$, $h$. Each time, we choose the smallest value for $r$ that allow an attack on the system. We display here the maximum weight $w$ chosen for the exponents $u_i$ of $g_{p^r}$ and the number of linearly independent lines these $g_{p^r}^{u_i}$ allow to generate (should be $w\cdot \frac{h}{r} +1$).


\begin{tabular}{|c|c|c|c|l|}
\hline
$p$ & $h$ & $r$ & $w_p(u_i)$ & Number of linearly independent lines  \\
\hline
197 & 24 & 2 & $w$ & $\frac{w(w+3)}{2} < 12w+1$ Attack impossible. \\
\hline
197 & 24 & 3 & 4 & 33\\
\hline
197 & 24 & 4 & 2 & 13\\
\hline
197 & 24 & $r \geq 6$ & 1 & $1 + h/r$ \\
\hline
193 & 36 & 2 & $w$ & $\frac{w(w+3)}{2} < 18w+1$ Attack impossible. \\
\hline
193 & 36 & 3 & 6 & 73\\
\hline
193 & 36 & 4 & 3 & 28\\
\hline
193 & 36 & 6 & 2 & 13\\
\hline
193 & 36 & $r \geq 9$ & 1 & $1 + h/r$ \\
\hline
251 & 60 & 2 & $w$ & $\frac{w(w+3)}{2} < 30w+1$ Attack impossible. \\
\hline
251 & 60 & 3 & 8 & 161\\
\hline
251 & 60 & 4 & 4 & 61\\
\hline
251 & 60 & 5 & 3 & 37\\
\hline
251 & 60 & 6 & 2 & 21\\
\hline
251 & 60 & $r \geq 10$ & 1 & $1 + h/r$ \\
\hline
\end{tabular}

When we choose, $r = 2$ and $w_p(u_i) \leq w$, the number of linearly independent lines is $\frac{w(w+3)}{2}$. This does not allow to attack the cryptosystem since to have $\frac{w(w+3)}{2} \geq 12w+1$, we would need $w \geq 22$ and if $w_p(u_i) = 2$, then the degree of the corresponding polynomials is $22 \times 12+1 = 265 > 197$.

Regarding that last set of examples, the Chor-Rivest attack would require to do an exhaustive research on approximately $251^{10}$ different possible generators of $\F_{p^{10}}$. With our approach, the cryptosystem can be attacked using the right generator $g_{p^3}$ of $\F_{p^3}$. The research is clearly a lot faster.

\subsubsection{Number of linearly independent polynomials}

We can study now the number of linearly independent polynomials that the writing of $g_{p^r}^{uc_j}$ can generate for all $u$ such that $w_p(u) \leq w$.

For example, for $r = 2$, it seems (experimentally) that the number of such linearly independent polynomials is always $\frac{w(w+3)}{2}$ and does not depend on $p$ or $h$.

For $r = 3$, the number of such linearly independent polynomials is $\frac{(w+1)(w+2)(w+3)}{6}-1$.

We could guess that for bigger $r$, this number is always $\Theta\left(\frac{w^r}{r!}\right)$.


\section{Draft}

We should prove that indeed at least $C\frac{w^r}{r!}$ linearly independent polynomials can be found in the coordinate of $g_{p^r}^{uc_j}$ with $w_p(u) \leq w$.

Then, we have that all we need for the attack to work is to choose $r$ such that there exists $w$ such that $w \cdot \frac{h}{r} + 1 \leq p-2$ and


\begin{eqnarray*}
C\frac{w^r}{r!} &\geq& w \frac{h}{r} \\
\Leftrightarrow C w^{r-1} &\geq& h\cdot (r-1)! \\
\Leftarrow C w^{r-1} &\geq& h (r-1)^{r-1} \\
\Leftarrow w &\geq& (r-1) \left(\frac{h}{C}\right)^{\frac{1}{r-1}} \geq C' r h^{\frac{1}{r-1}}
\end{eqnarray*}
This yield
\begin{eqnarray*}
C' h \cdot h^{\frac{1}{r-1}} &\leq& p-3 \\
\frac{\log h}{r-1} &\leq& \log (p-3) - \log h + C'' \\
r-1 &\geq& \frac{\log h}{\log(p-3) - \log h + C''} 
\end{eqnarray*}
besides, $h$ must be chosen such that
$$ h \simeq \frac{p}{\log p}$$
so
$$ r \geq \frac{\log p - \log \log p}{C'' + \log \log p} \geq C''' \frac{\log p}{\log\log p}$$
meaning that the research for a generator $g_{p^r}$ is almost polynomial...




\section{Conclusions}

We can notice that this attack on Chor-Rivest cryptosystem is only effective when $h$ possesses a small factor. For example, L. Hernandez Encinas \textit{et alii} \cite{Enc04} suggest to use $h$ prime. Such a cryptosystem remains however useless nowadays essentially because of the complexity of the discrete logarithm problem.





\bibliographystyle{abbrv}
\bibliography{references}
\newpage
\appendix
\end{document}
