
\documentclass[12pt,a4paper,titlepage]{article}

\usepackage[utf8]{inputenc}
\usepackage[english]{babel}
\usepackage[left=1.5cm,right=2cm,top=2cm,bottom=2cm]{geometry}

\input{defines}

% More definitions
\usepackage{showkeys}
\usepackage{mathtools}
\usepackage{multirow}
\usepackage{appendix}



\author{Sylvain Colin \& Gaspard FÃ©rey}
\title{The Sidelnikov-Shestakov's Attack applied to the Chor-Rivest Cryptosystem}

\begin{document}

\maketitle
\tableofcontents
\newpage




\begin{abstract}

In this article, we discuss about the Sidelnikov-Shestakov Attack on cryptosystems based on Reed-Solomon codes. Then we describe how this algorithm can be used to attack the Chor-Rivest Cryptosystem.



\end{abstract}


\section{Introduction}
\label{sec:intro}


\subsection{Our Work}


\section{Preliminaries}
\label{sec:defnot}


\subsection{A cryptosystem based on Reed-Solomon codes}

We study here the public-key cryptosystem introduced by Niederreiter \cite{NiederH86} applied to the generalized Reed-Solomon codes. Let $\F_q$ be a finite field with $q = p^h$ elements and $\F = \F_q \cup \{ \infty \}$, where $\infty$ has natural properties ( $1/\infty = 0$, etc). We call $\A$ the following matrix:
$$ \A(\alpha_1, \ ... \ , \alpha_n, z_1, \ ... \ , z_n) := \left(
\begin{array}{cccc}
z_1 \alpha_1^0 &  z_2 \alpha_2^0 & \cdots & z_n \alpha_n^0 \\
z_1 \alpha_1^1 &  z_2 \alpha_2^1 & \cdots & z_n \alpha_n^1 \\
 & & \ddots & \\
z_1 \alpha_1^{k-1} &  z_2 \alpha_2^{k-1} & \cdots & z_n \alpha_n^{k-1}
\end{array}
\right) \in \mathcal{M}_{\F_q}(k,n) $$
In the considered cryptosystem, the secret key consists of
\begin{itemize}
\item $(\alpha_i)_{1 \leq i \leq n}$ distinct elements of $\F_q$.
\item $(z_i)_{1 \leq i \leq n}$ elements of $\F_q - \{0\}$.
\item a random nonsingular $k\times k$-matrix $H$ over $\F$.
\end{itemize}
The public key is
\begin{itemize}
\item the representation of the field $\F$. In particular the polynomial used to define $\F$ is public.
\item The two integers $k$ and $n$ such that $ 0 < k < n \leq q$.
\item $M := H \cdot \A(\alpha_1, \ ... \ , \alpha_n, z_1, \ ... \ , z_n)$.
\end{itemize}

\subsection{Equivalence between Reed-Solomon codes}

Sidelnikov and Shestakov show \cite{SidelShes92} that for all $a \in \F_q-\{0\}$ and $b \in \F_q$, there exists $H_1, H_2, H_3 \in \mathcal{M}_{F_q}(k,k)$ invertible such that
\begin{eqnarray*}
H_1 \A(a\cdot\alpha_1 + b, \ ... \ , a\cdot \alpha_n + b, c_1z_1, \ ... \ , c_n z_n) &=& \A(\alpha_1, \ ... \ , \alpha_n, z_1, \ ... \ , z_n) \\
H_2 \A\left( \frac{1}{\alpha_1}, \ ... \ , \frac{1}{\alpha_n}, d_1z_1, \ ... \ , d_n z_n \right) &=& \A(\alpha_1, \ ... \ , \alpha_n, z_1, \ ... \ , z_n) \\
H_3 \A\left( \alpha_1, \ ... \ , \alpha_n, a\cdot z_1, \ ... \ , a\cdot z_n \right) &=& \A(\alpha_1, \ ... \ , \alpha_n, z_1, \ ... \ , z_n)
\end{eqnarray*}
This means that for any cryptosystem $M = H \A(\alpha_1, \ ... \ , \alpha_n, z_1, \ ... \ , z_n)$, for any birationnal transformation
$$ \phi : x \mapsto \frac{ax+b}{cx+d} $$
$M = H_{\phi} \A(\phi(\alpha_1), \ ... \ , \phi(\alpha_n), z'_1, \ ... \ , z'_n)$ and by using the unique transformation $\phi$ that maps $(\alpha_1, \alpha_2, \alpha_3)$ to $(0,1,\infty)$, we get that for any cryptosystem $M = H \A(\alpha_1, \ ... \ , \alpha_n, z_1, \ ... \ , z_n)$, $M$ can be uniquely written
$$ M = H' \A(0, 1, \infty, \alpha'_4, \ ... \ , \alpha'_n, 1, z'_2, \ ... \ , z'_n) $$
with $H'$ invertible, $z'_i \neq 0$ and $\alpha_i$ distincts elements of $\F_q-\{0, 1, \infty)$.

\section{Attack of Sidelnikov-Shestakov}

The attack of Sidelnikov-Shestakov consist of the following steps.

First we realize that the public key can be uniquely written as in the previous section.
$$ M = H' \A(0, 1, \infty, \alpha'_4, \ ... \ , \alpha'_n, 1, z'_2, \ ... \ , z'_n) $$

We compute then the echelon form of $M$.
$$ E(M) = 
\left(
\begin{array}{ccccccc}
1 & 0 & \cdots & 0 & b_{1,k+1} & \cdots & b_{1,n} \\
0 & 1 & \cdots & 0 & b_{2,k+1} & \cdots & b_{2,n} \\
  &   & \ddots &   & \vdots &   & \vdots \\
0 & \cdots & 0 & 1 & b_{k,k+1} & \cdots & b_{k,n}
\end{array}
\right) = H'' \cdot M
$$


For $2 \leq k \leq n-2$, this attack works with a complexity of ...


\section{Application to the Chor-Rivest Cryptosystem}

\subsection{The Chor-Rivest Cryptosystem}

Secret keys consist of
\begin{itemize}
\item an element $t \in \GF(q)$ with algebraic degree $h$
\item a generator $g$ of $\GF (q)^{\ast} $
\item an integer $d \in \Z_{q-1} $
\item a permutation $\pi$ of $\{ 0, ... , p-1 \}$.
\end{itemize}

Public keys consist of all
$$ c_i = d + \log_g(t + \alpha_{\pi(i)}) \mod q-1 $$

\subsection{A First Attack using Reed-Solomon codes}

We have for all $j$
$$ g^{c_j} = g^d \cdot (t + \alpha_{\pi(j)} ) = A + \alpha_{\pi(j)} \cdot B $$
where $\alpha_{\pi(j)} \in \GF(p)$ and $A$ and $B$ are elements of $\GF(p^h) \subset \GF(p)[X]$ and can be seen as polynomials of the variable $X$ with coefficients in $\GF(p)$.
Then if we consider an other generator $g_0$ of $\GF(q)^{\*}$, we have $g_0 = g^u$ and
$$ g_0 ^{c_j} = \left( A(X) + \alpha_{\pi(j)} \cdot B(X) \right)^u \mod \mu(X) $$
where $\mu$ is the polynomial of degree $h$ defining the field $\GF(q)$.

Besides we have
$$ g_0 ^{c_j} = \sum_{i=0}^{h-1} P_i(\alpha_{\pi(j)}) X^i $$
$P_i$ has its coefficients in $\GF(p)$ and depends on $A(X)$, $B(X)$, $u$ and obviously on $i$. However, $P_i$ does not depend on $j$.

Besides, we have
\begin{itemize}
\item $\deg P_i \leq u$ since the coefficients of $\left( A(X) + \alpha_{\pi(j)} \cdot B(X) \right)^u$ seen in $\GF(p)[X]$ are polynomials of degree smaller than $u$ in $\alpha_{\pi(j)}$.\\
When we compute the remain in the division of this polynomial by $\mu(X)$, these coefficients remain polynomials of degree smaller than $u$ in $\alpha_{\pi(j)}$.
\item $\deg P_i < p$ since $\alpha_{\pi(j)}^p = \alpha_{\pi(j)}$.
\end{itemize}

We now consider the matrix
$$ \A := \left( \alpha_{\pi(j)}^i \right)_{0 \leq i,j \leq p-1} \in \mathcal{M}_{\F_p}(p,p)$$
We call
\begin{itemize}
\item $P_i[j] \in \GF(p)$ the $j$-th coefficient of the polynomial $P_i$.
\item $H = \left( P_i[j] \right)_{i,j} \in \mathcal{M}_{\F_p}(h,p)$
\item $M = \left( P_i(\alpha_{\pi(j)}) \right)_{i,j} \in \mathcal{M}_{\F_p}(h,p)$.
\end{itemize}

$$ H \cdot \A = M $$

We suppose now that we try to guess the private generator $g$ but only find a generator $g_0$ such that $g_0 = g^u$ with $u < h$.

We can compute the elements $g_0^{c_j} \in \GF(q)$, the coefficients $P_i(\alpha_{\pi(j)}) \in \GF(p)$ and eventually the matrix $M$.

We consider now $H'$, the $u$ first columns of $H$ (the other columns are equal to 0) and $\A'$ the $u$ first rows of $\A$.
We get
$$ H' \cdot \A' = M $$

We suppose now that the first $u$ rows of $M$ are linearly independent. This allow us to consider only the first $u$ lines of the matrices $H'$ and $M$ ($H''$ and $M''$) which gives us
$$ H'' \cdot \A' = M'' $$
with
\begin{itemize}
\item $H'' \in \mathcal{M}_{\F_p}(u,u)$
\item $\A' \in \mathcal{M}_{\F_p}(u,p)$
\item $M'' \in \mathcal{M}_{\F_p}(u,p)$
\end{itemize}

We use then the attack seen on the first section to compute $\A'$ which gives us the permutation $\pi$.

\subsubsection{Problem}
It seems quite unlikely that $g_0 = g^u$ with a small $u$.
Indeed, there are $\phi(p^h-1)$ generators which is comparable to $p^h$ and the order of $h$ is only (in the suggested parameters) around 24. 

This could be solved if we had a way to rapidly check whether one generator is a small power of an other.

\subsubsection{Further...}

If $u$ is a small multiple of $p$, the previous arguments still apply since then $u = p u'$ with $u' < h$ and we get
$$ g_0^{c_j} = \left( \left( A(X) + \alpha_{\pi(i)} B(X) \right)^p \right)^{u'} = \left( A^p(X) + \alpha_{\pi(i)}^p B^p(X) \right)^{u'} = \left( A'(X) + \alpha_{\pi(i)} B'(X) \right)^{u'}$$
This only changes the polynomials $A$ and $B$ but still allow to compute the permutation $\pi(i)$ on these conditions.





\section{Conclusions}




\bibliographystyle{abbrv}
\bibliography{references}
\newpage
\appendix
\end{document}
